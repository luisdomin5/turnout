{
   "containerDefinitions": [
      {
         "dependsOn": [
            {
               "condition": "START",
               "containerName": "datadog-agent"
            },
            {
               "condition": "START",
               "containerName": "log_router"
            }
         ],
         "environment": [
            {
               "name": "DD_TRACE_ANALYTICS_ENABLED",
               "value": "true"
            },
            {
               "name": "DATADOG_SERVICE_NAME",
               "value": "turnoutweb"
            },
            {
               "name": "DATADOG_ENV",
               "value": "prod"
            },
            {
               "name": "DD_LOGS_INJECTION",
               "value": "true"
            },
            {
               "name": "DD_TAGS",
               "value": "env:prod,service:turnoutweb"
            }
         ],
         "essential": true,
         "healthCheck": {
            "command": [
               "CMD-SHELL",
               "curl --fail http://localhost:8000/-/health/ || exit 1"
            ],
            "interval": 30,
            "retries": 3,
            "timeout": 5
         },
         "image": "nginx/nginx:latest",
         "logConfiguration": {
            "logDriver": "awsfirelens",
            "options": {
               "Host": "http-intake.logs.datadoghq.com",
               "Name": "datadog",
               "TLS": "on",
               "dd_message_key": "log",
               "dd_service": "turnoutweb",
               "dd_source": "django",
               "dd_tags": "env:prod",
               "host": "http-intake.logs.datadoghq.com",
               "provider": "ecs"
            },
            "secretOptions": [
               {
                  "name": "apikey",
                  "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/general.datadogkey"
               }
            ]
         },
         "name": "web",
         "portMappings": [
            {
               "containerPort": 8000,
               "hostPort": 8000,
               "protocol": "tcp"
            }
         ],
         "secrets": [
            {
               "name": "DATABASE_URL",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.database_url"
            },
            {
               "name": "DATABASE_MAX_CONNECTIONS",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.database_max_connections"
            },
            {
               "name": "TARGETSMART_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.targetsmart_key"
            },
            {
               "name": "REDIS_URL",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.redis_url"
            },
            {
               "name": "SECRET_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.secret_key"
            },
            {
               "name": "ALLOWED_HOSTS",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.allowed_hosts"
            },
            {
               "name": "SENTRY_DSN",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.sentry_dsn"
            },
            {
               "name": "MULTIFACTOR_ISSUER",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.multifactor_issuer"
            },
            {
               "name": "ATTACHMENT_USE_S3",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.use_s3"
            },
            {
               "name": "AWS_STORAGE_BUCKET_NAME",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.public_storage_bucket"
            },
            {
               "name": "AWS_STORAGE_PRIVATE_BUCKET_NAME",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.private_storage_bucket"
            },
            {
               "name": "SENDGRID_API_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.sendgrid_api_key"
            },
            {
               "name": "FILE_TOKEN_RESET_URL",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.file_token_reset_url"
            },
            {
               "name": "PRIMARY_ORIGIN",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.primary_origin"
            },
            {
               "name": "USVOTEFOUNDATION_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.usvf_key"
            },
            {
               "name": "ALLOY_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.alloy_key"
            },
            {
               "name": "ALLOY_SECRET",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.alloy_secret"
            },
            {
               "name": "CLOUDFLARE_ZONE",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.cloudflare_zone"
            },
            {
               "name": "CLOUDFLARE_TOKEN",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.cloudflare_token"
            },
            {
               "name": "CLOUDFLARE_ENABLED",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.cloudflare_enabled"
            },
            {
               "name": "ABSENTEE_LEO_EMAIL_DISABLE",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.leo_email_disable"
            },
            {
               "name": "ABSENTEE_LEO_EMAIL_OVERRIDE_ADDRESS",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.leo_email_override_address"
            },
            {
               "name": "ABSENTEE_LEO_EMAIL_FROM",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.leo_email_from"
            },
            {
               "name": "TWILIO_ACCOUNT_SID",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.twilio_account_sid"
            },
            {
               "name": "TWILIO_AUTH_TOKEN",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.twilio_auth_token"
            },
            {
               "name": "TWILIO_MESSAGING_SERVICE_SID",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.twilio_messaging_service_sid"
            },
            {
               "name": "SMS_OPTIN_REMINDER_DELAY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.sms_optin_reminder_delay"
            },
            {
               "name": "SMS_POST_SIGNUP_ALERT",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.sms_post_signup_alert"
            },
            {
               "name": "MULTIFACTOR_ENABLED",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.multifactor_enabled"
            },
            {
               "name": "TWO_FACTOR_SMS_NUMBER",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.two_factor_sms_number"
            },
            {
               "name": "GEOCODIO_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.geocodio_key"
            },
            {
               "name": "FAX_DISABLE",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.fax_disable"
            },
            {
               "name": "FAX_OVERRIDE_DEST",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.fax_override_dest"
            },
            {
               "name": "FAX_GATEWAY_CALLBACK_URL",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.fax_gateway_callback_url"
            },
            {
               "name": "FAX_GATEWAY_SQS_QUEUE",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.fax_gateway_sqs_queue"
            },
            {
               "name": "SLACK_DATA_ERROR_ENABLED",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.slack_data_error_enabled"
            },
            {
               "name": "SLACK_DATA_ERROR_WEBHOOK",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.slack_data_error_webhook"
            },
            {
               "name": "USVF_SYNC",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.usvf_sync"
            },
            {
               "name": "USVF_SYNC_HOUR",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.usvf_sync_hour"
            },
            {
               "name": "DD_API_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/general.datadogkey"
            },
            {
               "name": "REGISTER_CO_VRD_ID",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.register_co_vrd_id"
            },
            {
               "name": "REGISTER_CO_VRD_ENABLED",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.register_co_vrd_enabled"
            },
            {
               "name": "REGISTER_WA_VRD_ID",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.register_wa_vrd_id"
            },
            {
               "name": "REGISTER_WA_VRD_ENABLED",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.register_wa_vrd_enabled"
            },
            {
               "name": "ACTIONNETWORK_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.actionnetwork_key"
            },
            {
               "name": "ACTIONNETWORK_SYNC",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.actionnetwork_sync"
            },
            {
               "name": "ACTIONNETWORK_SYNC_HOUR",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.actionnetwork_sync_hour"
            },
            {
               "name": "OPTIMIZELY_SDK_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.optimizely_sdk_key"
            },
            {
               "name": "UPTIMEDOTCOM_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.uptimedotcom_key"
            },
            {
               "name": "UPTIME_TWITTER_CONSUMER_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.uptime_twitter_consumer_key"
            },
            {
               "name": "UPTIME_TWITTER_CONSUMER_SECRET",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.uptime_twitter_consumer_secret"
            },
            {
               "name": "UPTIME_TWITTER_ACCESS_TOKEN",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.uptime_twitter_access_token"
            },
            {
               "name": "UPTIME_TWITTER_ACCESS_TOKEN_SECRET",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.uptime_twitter_access_token_secret"
            },
            {
               "name": "UPTIME_TWITTER_CRON_MINUTE",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.uptime_twitter_cron_minute"
            }
         ]
      },
      {
         "command": [
            "ddtrace-run",
            "celery",
            "-A",
            "turnout.celery_app",
            "worker",
            "-Q",
            "default",
            "--without-heartbeat"
         ],
         "dependsOn": [
            {
               "condition": "START",
               "containerName": "datadog-agent"
            },
            {
               "condition": "START",
               "containerName": "log_router"
            }
         ],
         "environment": [
            {
               "name": "DD_TRACE_ANALYTICS_ENABLED",
               "value": "true"
            },
            {
               "name": "DATADOG_SERVICE_NAME",
               "value": "turnoutworker"
            },
            {
               "name": "DATADOG_ENV",
               "value": "prod"
            },
            {
               "name": "DD_LOGS_INJECTION",
               "value": "true"
            },
            {
               "name": "DD_TAGS",
               "value": "env:prod,service:turnoutworker"
            }
         ],
         "essential": true,
         "image": "nginx/nginx:latest",
         "logConfiguration": {
            "logDriver": "awsfirelens",
            "options": {
               "Host": "http-intake.logs.datadoghq.com",
               "Name": "datadog",
               "TLS": "on",
               "dd_message_key": "log",
               "dd_service": "turnoutworker",
               "dd_source": "celery",
               "dd_tags": "env:prod",
               "host": "http-intake.logs.datadoghq.com",
               "provider": "ecs"
            },
            "secretOptions": [
               {
                  "name": "apikey",
                  "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/general.datadogkey"
               }
            ]
         },
         "name": "worker",
         "secrets": [
            {
               "name": "DATABASE_URL",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.database_url"
            },
            {
               "name": "DATABASE_MAX_CONNECTIONS",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.database_max_connections"
            },
            {
               "name": "TARGETSMART_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.targetsmart_key"
            },
            {
               "name": "REDIS_URL",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.redis_url"
            },
            {
               "name": "SECRET_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.secret_key"
            },
            {
               "name": "ALLOWED_HOSTS",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.allowed_hosts"
            },
            {
               "name": "SENTRY_DSN",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.sentry_dsn"
            },
            {
               "name": "MULTIFACTOR_ISSUER",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.multifactor_issuer"
            },
            {
               "name": "ATTACHMENT_USE_S3",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.use_s3"
            },
            {
               "name": "AWS_STORAGE_BUCKET_NAME",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.public_storage_bucket"
            },
            {
               "name": "AWS_STORAGE_PRIVATE_BUCKET_NAME",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.private_storage_bucket"
            },
            {
               "name": "SENDGRID_API_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.sendgrid_api_key"
            },
            {
               "name": "FILE_TOKEN_RESET_URL",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.file_token_reset_url"
            },
            {
               "name": "PRIMARY_ORIGIN",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.primary_origin"
            },
            {
               "name": "USVOTEFOUNDATION_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.usvf_key"
            },
            {
               "name": "ALLOY_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.alloy_key"
            },
            {
               "name": "ALLOY_SECRET",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.alloy_secret"
            },
            {
               "name": "CLOUDFLARE_ZONE",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.cloudflare_zone"
            },
            {
               "name": "CLOUDFLARE_TOKEN",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.cloudflare_token"
            },
            {
               "name": "CLOUDFLARE_ENABLED",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.cloudflare_enabled"
            },
            {
               "name": "ABSENTEE_LEO_EMAIL_DISABLE",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.leo_email_disable"
            },
            {
               "name": "ABSENTEE_LEO_EMAIL_OVERRIDE_ADDRESS",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.leo_email_override_address"
            },
            {
               "name": "ABSENTEE_LEO_EMAIL_FROM",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.leo_email_from"
            },
            {
               "name": "TWILIO_ACCOUNT_SID",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.twilio_account_sid"
            },
            {
               "name": "TWILIO_AUTH_TOKEN",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.twilio_auth_token"
            },
            {
               "name": "TWILIO_MESSAGING_SERVICE_SID",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.twilio_messaging_service_sid"
            },
            {
               "name": "SMS_OPTIN_REMINDER_DELAY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.sms_optin_reminder_delay"
            },
            {
               "name": "SMS_POST_SIGNUP_ALERT",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.sms_post_signup_alert"
            },
            {
               "name": "MULTIFACTOR_ENABLED",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.multifactor_enabled"
            },
            {
               "name": "TWO_FACTOR_SMS_NUMBER",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.two_factor_sms_number"
            },
            {
               "name": "GEOCODIO_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.geocodio_key"
            },
            {
               "name": "FAX_DISABLE",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.fax_disable"
            },
            {
               "name": "FAX_OVERRIDE_DEST",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.fax_override_dest"
            },
            {
               "name": "FAX_GATEWAY_CALLBACK_URL",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.fax_gateway_callback_url"
            },
            {
               "name": "FAX_GATEWAY_SQS_QUEUE",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.fax_gateway_sqs_queue"
            },
            {
               "name": "SLACK_DATA_ERROR_ENABLED",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.slack_data_error_enabled"
            },
            {
               "name": "SLACK_DATA_ERROR_WEBHOOK",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.slack_data_error_webhook"
            },
            {
               "name": "USVF_SYNC",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.usvf_sync"
            },
            {
               "name": "USVF_SYNC_HOUR",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.usvf_sync_hour"
            },
            {
               "name": "DD_API_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/general.datadogkey"
            },
            {
               "name": "REGISTER_CO_VRD_ID",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.register_co_vrd_id"
            },
            {
               "name": "REGISTER_CO_VRD_ENABLED",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.register_co_vrd_enabled"
            },
            {
               "name": "REGISTER_WA_VRD_ID",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.register_wa_vrd_id"
            },
            {
               "name": "REGISTER_WA_VRD_ENABLED",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.register_wa_vrd_enabled"
            },
            {
               "name": "ACTIONNETWORK_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.actionnetwork_key"
            },
            {
               "name": "ACTIONNETWORK_SYNC",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.actionnetwork_sync"
            },
            {
               "name": "ACTIONNETWORK_SYNC_HOUR",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.actionnetwork_sync_hour"
            },
            {
               "name": "OPTIMIZELY_SDK_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.optimizely_sdk_key"
            },
            {
               "name": "UPTIMEDOTCOM_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.uptimedotcom_key"
            },
            {
               "name": "UPTIME_TWITTER_CONSUMER_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.uptime_twitter_consumer_key"
            },
            {
               "name": "UPTIME_TWITTER_CONSUMER_SECRET",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.uptime_twitter_consumer_secret"
            },
            {
               "name": "UPTIME_TWITTER_ACCESS_TOKEN",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.uptime_twitter_access_token"
            },
            {
               "name": "UPTIME_TWITTER_ACCESS_TOKEN_SECRET",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.uptime_twitter_access_token_secret"
            },
            {
               "name": "UPTIME_TWITTER_CRON_MINUTE",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.uptime_twitter_cron_minute"
            }
         ]
      },
      {
         "command": [
            "ddtrace-run",
            "celery",
            "-A",
            "turnout.celery_app",
            "beat",
            "--scheduler",
            "redbeat.RedBeatScheduler"
         ],
         "dependsOn": [
            {
               "condition": "START",
               "containerName": "datadog-agent"
            },
            {
               "condition": "START",
               "containerName": "log_router"
            }
         ],
         "environment": [
            {
               "name": "DD_TRACE_ANALYTICS_ENABLED",
               "value": "true"
            },
            {
               "name": "DATADOG_SERVICE_NAME",
               "value": "turnoutbeat"
            },
            {
               "name": "DATADOG_ENV",
               "value": "prod"
            },
            {
               "name": "DD_LOGS_INJECTION",
               "value": "true"
            },
            {
               "name": "DD_TAGS",
               "value": "env:prod,service:turnoutbeat"
            }
         ],
         "essential": true,
         "image": "nginx/nginx:latest",
         "logConfiguration": {
            "logDriver": "awsfirelens",
            "options": {
               "Host": "http-intake.logs.datadoghq.com",
               "Name": "datadog",
               "TLS": "on",
               "dd_message_key": "log",
               "dd_service": "turnoutbeat",
               "dd_source": "celerybeat",
               "dd_tags": "env:prod",
               "host": "http-intake.logs.datadoghq.com",
               "provider": "ecs"
            },
            "secretOptions": [
               {
                  "name": "apikey",
                  "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/general.datadogkey"
               }
            ]
         },
         "name": "beat",
         "secrets": [
            {
               "name": "DATABASE_URL",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.database_url"
            },
            {
               "name": "DATABASE_MAX_CONNECTIONS",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.database_max_connections"
            },
            {
               "name": "TARGETSMART_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.targetsmart_key"
            },
            {
               "name": "REDIS_URL",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.redis_url"
            },
            {
               "name": "SECRET_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.secret_key"
            },
            {
               "name": "ALLOWED_HOSTS",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.allowed_hosts"
            },
            {
               "name": "SENTRY_DSN",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.sentry_dsn"
            },
            {
               "name": "MULTIFACTOR_ISSUER",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.multifactor_issuer"
            },
            {
               "name": "ATTACHMENT_USE_S3",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.use_s3"
            },
            {
               "name": "AWS_STORAGE_BUCKET_NAME",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.public_storage_bucket"
            },
            {
               "name": "AWS_STORAGE_PRIVATE_BUCKET_NAME",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.private_storage_bucket"
            },
            {
               "name": "SENDGRID_API_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.sendgrid_api_key"
            },
            {
               "name": "FILE_TOKEN_RESET_URL",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.file_token_reset_url"
            },
            {
               "name": "PRIMARY_ORIGIN",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.primary_origin"
            },
            {
               "name": "USVOTEFOUNDATION_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.usvf_key"
            },
            {
               "name": "ALLOY_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.alloy_key"
            },
            {
               "name": "ALLOY_SECRET",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.alloy_secret"
            },
            {
               "name": "CLOUDFLARE_ZONE",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.cloudflare_zone"
            },
            {
               "name": "CLOUDFLARE_TOKEN",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.cloudflare_token"
            },
            {
               "name": "CLOUDFLARE_ENABLED",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.cloudflare_enabled"
            },
            {
               "name": "ABSENTEE_LEO_EMAIL_DISABLE",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.leo_email_disable"
            },
            {
               "name": "ABSENTEE_LEO_EMAIL_OVERRIDE_ADDRESS",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.leo_email_override_address"
            },
            {
               "name": "ABSENTEE_LEO_EMAIL_FROM",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.leo_email_from"
            },
            {
               "name": "TWILIO_ACCOUNT_SID",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.twilio_account_sid"
            },
            {
               "name": "TWILIO_AUTH_TOKEN",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.twilio_auth_token"
            },
            {
               "name": "TWILIO_MESSAGING_SERVICE_SID",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.twilio_messaging_service_sid"
            },
            {
               "name": "SMS_OPTIN_REMINDER_DELAY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.sms_optin_reminder_delay"
            },
            {
               "name": "SMS_POST_SIGNUP_ALERT",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.sms_post_signup_alert"
            },
            {
               "name": "MULTIFACTOR_ENABLED",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.multifactor_enabled"
            },
            {
               "name": "TWO_FACTOR_SMS_NUMBER",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.two_factor_sms_number"
            },
            {
               "name": "GEOCODIO_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.geocodio_key"
            },
            {
               "name": "FAX_DISABLE",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.fax_disable"
            },
            {
               "name": "FAX_OVERRIDE_DEST",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.fax_override_dest"
            },
            {
               "name": "FAX_GATEWAY_CALLBACK_URL",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.fax_gateway_callback_url"
            },
            {
               "name": "FAX_GATEWAY_SQS_QUEUE",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.fax_gateway_sqs_queue"
            },
            {
               "name": "SLACK_DATA_ERROR_ENABLED",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.slack_data_error_enabled"
            },
            {
               "name": "SLACK_DATA_ERROR_WEBHOOK",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.slack_data_error_webhook"
            },
            {
               "name": "USVF_SYNC",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.usvf_sync"
            },
            {
               "name": "USVF_SYNC_HOUR",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.usvf_sync_hour"
            },
            {
               "name": "DD_API_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/general.datadogkey"
            },
            {
               "name": "REGISTER_CO_VRD_ID",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.register_co_vrd_id"
            },
            {
               "name": "REGISTER_CO_VRD_ENABLED",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.register_co_vrd_enabled"
            },
            {
               "name": "REGISTER_WA_VRD_ID",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.register_wa_vrd_id"
            },
            {
               "name": "REGISTER_WA_VRD_ENABLED",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.register_wa_vrd_enabled"
            },
            {
               "name": "ACTIONNETWORK_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.actionnetwork_key"
            },
            {
               "name": "ACTIONNETWORK_SYNC",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.actionnetwork_sync"
            },
            {
               "name": "ACTIONNETWORK_SYNC_HOUR",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.actionnetwork_sync_hour"
            },
            {
               "name": "OPTIMIZELY_SDK_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.optimizely_sdk_key"
            },
            {
               "name": "UPTIMEDOTCOM_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.uptimedotcom_key"
            },
            {
               "name": "UPTIME_TWITTER_CONSUMER_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.uptime_twitter_consumer_key"
            },
            {
               "name": "UPTIME_TWITTER_CONSUMER_SECRET",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.uptime_twitter_consumer_secret"
            },
            {
               "name": "UPTIME_TWITTER_ACCESS_TOKEN",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.uptime_twitter_access_token"
            },
            {
               "name": "UPTIME_TWITTER_ACCESS_TOKEN_SECRET",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.uptime_twitter_access_token_secret"
            },
            {
               "name": "UPTIME_TWITTER_CRON_MINUTE",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/turnout.prod.uptime_twitter_cron_minute"
            }
         ]
      },
      {
         "dependsOn": [
            {
               "condition": "START",
               "containerName": "log_router"
            }
         ],
         "environment": [
            {
               "name": "ECS_FARGATE",
               "value": "true"
            },
            {
               "name": "DD_DOCKER_LABELS_AS_TAGS",
               "value": "{\"spinnaker.stack\":\"spinnaker_stack\", \"spinnaker.servergroup\":\"spinnaker_servergroup\", \"spinnaker.detail\":\"spinnaker_detail\", \"spinnaker.stack\":\"env\"}"
            },
            {
               "name": "DD_APM_ENABLED",
               "value": "true"
            },
            {
               "name": "DD_DOGSTATSD_NON_LOCAL_TRAFFIC",
               "value": "true"
            }
         ],
         "essential": true,
         "image": "datadog/agent:latest",
         "logConfiguration": {
            "logDriver": "awsfirelens",
            "options": {
               "Host": "http-intake.logs.datadoghq.com",
               "Name": "datadog",
               "TLS": "on",
               "dd_message_key": "log",
               "dd_service": "turnout-datadog",
               "dd_source": "datadog",
               "dd_tags": "env:prod",
               "host": "http-intake.logs.datadoghq.com",
               "provider": "ecs"
            },
            "secretOptions": [
               {
                  "name": "apikey",
                  "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/general.datadogkey"
               }
            ]
         },
         "name": "datadog-agent",
         "secrets": [
            {
               "name": "DD_API_KEY",
               "valueFrom": "arn:aws:ssm:us-west-2:719108811834:parameter/general.datadogkey"
            }
         ]
      },
      {
         "essential": true,
         "firelensConfiguration": {
            "options": {
               "enable-ecs-log-metadata": "true"
            },
            "type": "fluentbit"
         },
         "image": "amazon/aws-for-fluent-bit:latest",
         "logConfiguration": {
            "logDriver": "awslogs",
            "options": {
               "awslogs-group": "/voteamerica/ecs/turnout/prod",
               "awslogs-region": "us-west-2",
               "awslogs-stream-prefix": "turnout-fluentbit"
            }
         },
         "name": "log_router"
      }
   ],
   "cpu": "4096",
   "executionRoleArn": "arn:aws:iam::719108811834:role/Turnout-ECS-Prod",
   "memory": "8192",
   "networkMode": "awsvpc",
   "requiresCompatibilities": [
      "FARGATE"
   ],
   "taskRoleArn": "arn:aws:iam::719108811834:role/Turnout-ECS-Prod-TaskRole"
}
